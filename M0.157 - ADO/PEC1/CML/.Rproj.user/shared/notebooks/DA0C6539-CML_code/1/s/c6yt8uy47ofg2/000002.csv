"0","library(ggplot2)"
"0","library(ggrepel)"
"0","plotPCA3 <- function (datos, labels, factor, title, scale,colores, size = 1.5, glineas = 0.25) {"
"0","  data <- prcomp(t(datos),scale=scale)"
"0","  # plot adjustments"
"0","  data_df <- data.frame(data$x)"
"0","  Group <- factor"
"0","  loads <- round(data$sdev^2/sum(data$sdev^2)*100,1)"
"0","  # main plot"
"0","  p1 <- ggplot(data_df,aes(x=PC1, y=PC2)) +"
"0","    theme_classic() +"
"0","    geom_hline(yintercept = 0, color = ""gray70"") +"
"0","    geom_vline(xintercept = 0, color = ""gray70"") +"
"0","    geom_point(aes(color = Group), alpha = 0.55, size = 3) +"
"0","    coord_cartesian(xlim = c(min(data$x[,1])-5,max(data$x[,1])+5)) +"
"0","    scale_fill_discrete(name = ""Group"")"
"0","  # avoiding labels superposition "
"0","  p1 + geom_text_repel(aes(y = PC2 + 0.25, label = labels),segment.size = 0.25, size = size) + "
"0","    labs(x = c(paste(""PC1"",loads[1],""%"")),y=c(paste(""PC2"",loads[2],""%""))) +  "
"0","    ggtitle(paste(""Principal Component Analysis for: "",title,sep="" ""))+ "
"0","    theme(plot.title = element_text(hjust = 0.5)) +"
"0","    scale_color_manual(values=colores)"
"0","}"
